var Ads=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function a(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var i=new WeakSet,r=new WeakSet,o=new WeakSet,s=new WeakSet,l=function(){function l(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e(this,l),n(this,s),n(this,o),n(this,r),n(this,i),this.testnet=t,this.port=null,this.initialized=!1,this.queue=[],this.iframeOrigin="https://connect.adshares.net"}var c,u,d;return c=l,u=[{key:"isWalletInstalled",value:function(){return a(this,s,h).call(this,"walletInstalled")}},{key:"getWalletInfo",value:function(){return a(this,s,h).call(this,"walletInfo")}},{key:"pingWallet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a(this,s,h).call(this,"pingWallet",{data:e})}},{key:"getClientInfo",value:function(){return a(this,s,h).call(this,"clientInfo")}},{key:"pingClient",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a(this,s,h).call(this,"pingClient",{data:e})}},{key:"authenticate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a(this,s,h).call(this,"authenticate",{nonce:e,hostname:window.location.host})}},{key:"broadcast",value:function(e){return a(this,s,h).call(this,"broadcast",{message:e})}},{key:"sendOne",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return a(this,s,h).call(this,"sendOne",{recipient:e,amount:t,message:n})}}],u&&t(c.prototype,u),d&&t(c,d),l}();function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function u(){var e=this;return new Promise((function(t,n){var i=new MessageChannel;if(i.port1.onmessage=function(t){return a(e,o,d).call(e,t)},i.port1.start(),e.port)return e.initialized?t(i.port2):n("ADS Connector is not ready yet");var r=document.createElement("iframe");r.src=e.iframeOrigin+"/index.html",r.setAttribute("style","display:none"),document.body.appendChild(r),r.addEventListener("load",(function(){e.initialized=!0,t(i.port2)})),e.port=r.contentWindow}))}function d(e){if(console.debug("#onMessage",e),!e.data||!e.data.id)throw new Error("ADS Connector: malformed message");var t=this.queue.find((function(t){return t.id===e.data.id}));if(e.data.error){if(!t||!t.reject)throw new Error("ADS Connector: cannot reject message ".concat(e.data.id));t.reject("".concat(e.data.error.code,": ").concat(e.data.error.message))}else if(!t||!t.resolve)throw new Error("ADS Connector: cannot resolve message ".concat(e.data.id));t.resolve(e.data.data)}function h(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(s,l){a(n,r,u).call(n).then((function(r){var u=a(n,i,c).call(n);n.queue.push({id:u,resolve:s,reject:l}),n.port.postMessage({id:u,testnet:n.testnet,type:e,data:t,options:o},"*",[r])}),l)}))}return l}();
